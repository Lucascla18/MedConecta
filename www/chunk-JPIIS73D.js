import{a as at,d as rt,e as st,f as ct,j as lt,k as pt,m as dt}from"./chunk-BI3SNNQC.js";import{D as ot,J as it}from"./chunk-RMY4OVEQ.js";import{A as u,B as n,Ba as K,C as i,D as I,E as M,Ea as Q,F as b,Fa as X,G as g,H as S,I as k,Ia as Y,J as T,K as p,Ka as tt,L as O,M as E,Ma as et,N as D,O as L,P as A,Pa as nt,Q as N,S as z,U as F,V,W as j,da as q,ga as B,la as R,m,ma as W,q as h,r as C,ta as H,va as $,w as s,wa as U,x as v,xa as Z,y as w,ya as G,z as x,za as J}from"./chunk-HUONWBXV.js";import"./chunk-WFQEB5QE.js";import"./chunk-7KGURMOZ.js";import"./chunk-KMRFCD75.js";import"./chunk-62GOUXOV.js";import"./chunk-QQOM2FGK.js";import"./chunk-KMHLOZFG.js";import"./chunk-NFKFN677.js";import"./chunk-4WFVMWDK.js";import"./chunk-MDMZPGPE.js";import"./chunk-L533IC4V.js";import"./chunk-NY44LQGJ.js";import"./chunk-IFR4H3YE.js";import"./chunk-LF5XB4YN.js";import{a as y,e as _}from"./chunk-BDMMXEV4.js";function ft(a,c){if(a&1){let l=M();n(0,"div",15)(1,"ion-button",16),b("click",function(){h(l);let o=g().$implicit,r=g(2);return C(r.reschedule(o))}),p(2," Remarcar "),i(),n(3,"ion-button",17),b("click",function(){h(l);let o=g().$implicit,r=g(2);return C(r.cancelAppointment(o))}),p(4," Cancelar "),i()()}}function ut(a,c){if(a&1&&(n(0,"ion-card",8)(1,"ion-item",9)(2,"div",10),p(3),i(),n(4,"ion-label")(5,"h2"),p(6),i(),n(7,"p"),p(8),i()()(),n(9,"div",11)(10,"div",12),I(11,"ion-icon",13),n(12,"span"),p(13),i()(),x(14,ft,5,0,"div",14),i()()),a&2){let l=c.$implicit,e=g(2);T("past",e.selectedSegment==="past"),s(2),k("background-color",l.doctorColor),s(),E(" ",l.doctorInitials," "),s(3),O(l.doctorName),s(2),O(l.specialty),s(3),u("name",e.selectedSegment==="upcoming"?"calendar-outline":"checkmark-circle"),s(2),D("",l.dateLabel," \u2022 ",l.timeLabel),s(),u("ngIf",e.selectedSegment==="upcoming")}}function _t(a,c){if(a&1&&(n(0,"div"),x(1,ut,15,11,"ion-card",7),i()),a&2){let l=g();s(),u("ngForOf",l.displayedAppointments)}}function ht(a,c){a&1&&(n(0,"div",18)(1,"p"),p(2,"Nenhuma consulta encontrada."),i()())}var St=(()=>{let c=class c{constructor(){this.selectedSegment="upcoming",this.displayedAppointments=[],this.upcomingList=[],this.pastList=[],this.auth=m(ot),this.firestore=m(at),this.zone=m(v),this.toastCtrl=m(tt),this.alertCtrl=m(Y),this.navCtrl=m(W)}ngOnInit(){this.loadAppointments()}loadAppointments(){it(this.auth,e=>{if(e){let o=pt(rt(this.firestore,"appointments"),dt("userId","==",e.uid));lt(o,r=>{this.zone.run(()=>{let f=r.docs.map(t=>y({id:t.id},t.data()));this.upcomingList=[],this.pastList=[];let P=new Date;f.forEach(t=>{if(!t.dateIso||!t.timeLabel)return;let d=new Date(t.dateIso),[mt,gt]=t.timeLabel.split(":");d.setHours(parseInt(mt),parseInt(gt),0,0),t.fullDate=d,d>=P?this.upcomingList.push(t):this.pastList.push(t)}),this.upcomingList.sort((t,d)=>t.fullDate.getTime()-d.fullDate.getTime()),this.pastList.sort((t,d)=>d.fullDate.getTime()-t.fullDate.getTime()),this.updateDisplay()})})}else this.navCtrl.navigateRoot("/login")})}segmentChanged(e){this.updateDisplay()}updateDisplay(){this.selectedSegment==="upcoming"?this.displayedAppointments=this.upcomingList:this.displayedAppointments=this.pastList}reschedule(e){return _(this,null,function*(){let o={queryParams:{doctorName:e.doctorName}};this.navCtrl.navigateForward(["/agendamento"],o)})}cancelAppointment(e){return _(this,null,function*(){yield(yield this.alertCtrl.create({header:"Cancelar Consulta?",message:`Deseja cancelar o agendamento com ${e.doctorName}?`,buttons:[{text:"N\xE3o",role:"cancel"},{text:"Sim, cancelar",role:"destructive",handler:()=>_(this,null,function*(){try{yield st(ct(this.firestore,"appointments",e.id)),this.presentToast("Consulta cancelada com sucesso.")}catch(r){console.error(r),this.presentToast("Erro ao cancelar.")}})}]})).present()})}presentToast(e){return _(this,null,function*(){(yield this.toastCtrl.create({message:e,duration:2e3,position:"bottom",color:"dark"})).present()})}};c.\u0275fac=function(o){return new(o||c)},c.\u0275cmp=w({type:c,selectors:[["app-consultas"]],decls:16,vars:4,consts:[["emptyState",""],[1,"ion-no-border"],["mode","ios",3,"ngModelChange","ionChange","ngModel"],["value","upcoming"],["value","past"],[3,"fullscreen"],[4,"ngIf","ngIfElse"],["class","appointment-list-card",3,"past",4,"ngFor","ngForOf"],[1,"appointment-list-card"],["lines","none"],["slot","start",1,"list-avatar"],[1,"card-footer"],[1,"time-badge"],[3,"name"],["class","action-buttons",4,"ngIf"],[1,"action-buttons"],["fill","clear","color","dark","size","small",3,"click"],["fill","clear","color","danger","size","small",3,"click"],[1,"empty-container"]],template:function(o,r){if(o&1){let f=M();n(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),p(3,"Minhas Consultas"),i()(),n(4,"ion-toolbar")(5,"ion-segment",2),N("ngModelChange",function(t){return h(f),A(r.selectedSegment,t)||(r.selectedSegment=t),C(t)}),b("ionChange",function(t){return h(f),C(r.segmentChanged(t))}),n(6,"ion-segment-button",3)(7,"ion-label"),p(8,"Pr\xF3ximas"),i()(),n(9,"ion-segment-button",4)(10,"ion-label"),p(11,"Anteriores"),i()()()()(),n(12,"ion-content",5),x(13,_t,2,1,"div",6)(14,ht,3,0,"ng-template",null,0,z),i()}if(o&2){let f=S(15);s(5),L("ngModel",r.selectedSegment),s(7),u("fullscreen",!0),s(),u("ngIf",r.displayedAppointments.length>0)("ngIfElse",f)}},dependencies:[j,F,V,R,q,B,Z,X,Q,nt,K,J,U,$,G,et,H],styles:['@charset "UTF-8";ion-toolbar[_ngcontent-%COMP%]{--background: #ffffff}ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-weight:700;color:#1e293b;padding-left:16px}ion-content[_ngcontent-%COMP%]{--background: #f8fafc}ion-segment[_ngcontent-%COMP%]{background:#f1f5f9;margin:16px;padding:4px;border-radius:12px;width:auto}ion-segment-button[_ngcontent-%COMP%]{--indicator-color: transparent;--background-checked: #ffffff;--color-checked: var(--ion-color-primary);--color: #64748b;min-height:36px;border-radius:8px;font-weight:600;margin:0;flex:1;transition:transform .2s ease}ion-segment-button.segment-button-checked[_ngcontent-%COMP%]{box-shadow:0 2px 8px #00000014}.appointment-list-card[_ngcontent-%COMP%]{margin:16px;padding:0;border-radius:16px;box-shadow:0 4px 12px #0000000d;background:#fff;border:1px solid #f1f5f9;overflow:hidden}ion-item[_ngcontent-%COMP%]{--background: transparent;--padding-start: 16px;--inner-padding-end: 16px;padding-top:12px}.list-avatar[_ngcontent-%COMP%]{width:55px;height:55px;border-radius:50%;margin-right:16px;display:flex;align-items:center;justify-content:center;color:#334155;font-weight:800;font-size:18px;box-shadow:0 4px 10px #00000014;border:2px solid #ffffff;transition:all .3s ease}.appointment-list-card.past[_ngcontent-%COMP%]   .list-avatar[_ngcontent-%COMP%]{filter:grayscale(100%);opacity:.5;box-shadow:none;color:#fff}ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:#1e293b;margin-bottom:4px}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:500}.card-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-top:1px solid #f1f5f9;margin-top:8px;background:#fcfcfc}.time-badge[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:13px;color:#475569;font-weight:600}.time-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;margin-right:6px;color:var(--ion-color-primary)}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.action-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0;font-weight:600;font-size:13px;height:32px}@media (max-width: 380px){.card-footer[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.time-badge[_ngcontent-%COMP%]{width:100%;margin-bottom:4px}.action-buttons[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.action-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{flex:1}}.appointment-list-card.past[_ngcontent-%COMP%]{background:#f8fafc;border-color:#e2e8f0}.appointment-list-card.past[_ngcontent-%COMP%]   .list-avatar[_ngcontent-%COMP%]{filter:grayscale(100%);opacity:.6}.appointment-list-card.past[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .appointment-list-card.past[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#94a3b8}.appointment-list-card.past[_ngcontent-%COMP%]   .time-badge[_ngcontent-%COMP%]{color:#94a3b8}.appointment-list-card.past[_ngcontent-%COMP%]   .time-badge[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#94a3b8}.empty-container[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#94a3b8}.empty-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;font-weight:500}']});let a=c;return a})();export{St as ConsultasPage};
